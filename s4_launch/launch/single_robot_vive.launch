<?xml version="1.0"?>
<launch>
    <arg name="robot" default="default_robot"/>
    <arg name="target" default="sim"/>
	<arg name="vive" default="sim"/>

    <group ns="share">
        <node name="rviz" pkg="rviz" type="rviz" args="-d $(find s4_launch)/rviz/single_robot.rviz" required="true" />
		<node name="joy_node"  pkg="joy" type="joy_node" />

	    <arg name="model" default="$(find s4_vive)/urdf/world.urdf.xacro"/>
    	<param name="robot_description" command="$(find xacro)/xacro --inorder $(arg model)" />
    	<node name="robot_state_publisher" pkg="robot_state_publisher" type="robot_state_publisher" >
			<param name="robot_description" value="$(arg robot)/robot_description" />
			<param name="tf_prefix" value="share"/>
	    </node>

		<include file="$(find s4_vive)/launch/main.launch" >
			<arg name="target" value="$(arg vive)"/>
			<arg name="ns"     value="share"/>
			<arg name="unit"   value="vive0"/>
			<arg name="c0_name" value="LHR_FFF91D43"/>
			<arg name="t0_name" value="LHR_FD5964F8"/>
    	</include>

		<node name="s4_operate_vive_control"  pkg="s4_operate" type="s4_operate_vive_control">
            <param name="goal_frame" value="share/vive0/controller0/goal_link"/>
			<remap from="pose" to="/$(arg robot)/omni0/pose" />
			<remap from="target" to="/$(arg robot)/gun0/aim_target" />
			<remap from="joy" to="/share/vive0/controller0/joy" />
        </node>


		<node pkg="tf" type="static_transform_publisher" name="tf_overlap" args="0.0 0.0 0 0.0 0.0 0 share/vive0/tracker0/tracking_link $(arg robot)/base_link 100" />
    </group>

	<include file="$(find s4_system)/launch/srs004_spawn.launch" >
		<arg name="robot"  value="$(arg robot)"/>
		<arg name="target" value="$(arg target)"/>
	</include>
</launch>

